{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.FormDataHelper = void 0;\n\nconst helpers_1 = require(\"../helpers\"); // This class is partially inspired by https://github.com/form-data/form-data/blob/master/lib/form_data.js\n// All credits to their authors.\n\n\nclass FormDataHelper {\n  constructor() {\n    this._boundary = '';\n    this._chunks = [];\n  }\n\n  bodyAppend() {\n    for (var _len = arguments.length, values = new Array(_len), _key = 0; _key < _len; _key++) {\n      values[_key] = arguments[_key];\n    }\n\n    const allAsBuffer = values.map(val => val instanceof Buffer ? val : Buffer.from(val));\n\n    this._chunks.push(...allAsBuffer);\n  }\n\n  append(field, value, contentType) {\n    const convertedValue = value instanceof Buffer ? value : value.toString();\n    const header = this.getMultipartHeader(field, convertedValue, contentType);\n    this.bodyAppend(header, convertedValue, FormDataHelper.LINE_BREAK);\n  }\n\n  getHeaders() {\n    return {\n      'content-type': 'multipart/form-data; boundary=' + this.getBoundary()\n    };\n  }\n  /** Length of form-data (including footer length). */\n\n\n  getLength() {\n    return this._chunks.reduce((acc, cur) => acc + cur.length, this.getMultipartFooter().length);\n  }\n\n  getBuffer() {\n    const allChunks = [...this._chunks, this.getMultipartFooter()];\n    const totalBuffer = Buffer.alloc(this.getLength());\n    let i = 0;\n\n    for (const chunk of allChunks) {\n      for (let j = 0; j < chunk.length; i++, j++) {\n        totalBuffer[i] = chunk[j];\n      }\n    }\n\n    return totalBuffer;\n  }\n\n  getBoundary() {\n    if (!this._boundary) {\n      this.generateBoundary();\n    }\n\n    return this._boundary;\n  }\n\n  generateBoundary() {\n    // This generates a 50 character boundary similar to those used by Firefox.\n    let boundary = '--------------------------';\n\n    for (let i = 0; i < 24; i++) {\n      boundary += Math.floor(Math.random() * 10).toString(16);\n    }\n\n    this._boundary = boundary;\n  }\n\n  getMultipartHeader(field, value, contentType) {\n    // In this lib no need to guess more the content type, octet stream is ok of buffers\n    if (!contentType) {\n      contentType = value instanceof Buffer ? FormDataHelper.DEFAULT_CONTENT_TYPE : '';\n    }\n\n    const headers = {\n      'Content-Disposition': ['form-data', `name=\"${field}\"`],\n      'Content-Type': contentType\n    };\n    let contents = '';\n\n    for (const [prop, header] of Object.entries(headers)) {\n      // skip nullish headers.\n      if (!header.length) {\n        continue;\n      }\n\n      contents += prop + ': ' + helpers_1.arrayWrap(header).join('; ') + FormDataHelper.LINE_BREAK;\n    }\n\n    return '--' + this.getBoundary() + FormDataHelper.LINE_BREAK + contents + FormDataHelper.LINE_BREAK;\n  }\n\n  getMultipartFooter() {\n    if (this._footerChunk) {\n      return this._footerChunk;\n    }\n\n    return this._footerChunk = Buffer.from('--' + this.getBoundary() + '--' + FormDataHelper.LINE_BREAK);\n  }\n\n}\n\nexports.FormDataHelper = FormDataHelper;\nFormDataHelper.LINE_BREAK = '\\r\\n';\nFormDataHelper.DEFAULT_CONTENT_TYPE = 'application/octet-stream';","map":{"version":3,"sources":["/Users/tarungunampalli/Documents/twitter-oauth/node_modules/twitter-api-v2/dist/client-mixins/form-data.helper.js"],"names":["Object","defineProperty","exports","value","FormDataHelper","helpers_1","require","constructor","_boundary","_chunks","bodyAppend","values","allAsBuffer","map","val","Buffer","from","push","append","field","contentType","convertedValue","toString","header","getMultipartHeader","LINE_BREAK","getHeaders","getBoundary","getLength","reduce","acc","cur","length","getMultipartFooter","getBuffer","allChunks","totalBuffer","alloc","i","chunk","j","generateBoundary","boundary","Math","floor","random","DEFAULT_CONTENT_TYPE","headers","contents","prop","entries","arrayWrap","join","_footerChunk"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FormDataHelper = void 0;\nconst helpers_1 = require(\"../helpers\");\n// This class is partially inspired by https://github.com/form-data/form-data/blob/master/lib/form_data.js\n// All credits to their authors.\nclass FormDataHelper {\n    constructor() {\n        this._boundary = '';\n        this._chunks = [];\n    }\n    bodyAppend(...values) {\n        const allAsBuffer = values.map(val => val instanceof Buffer ? val : Buffer.from(val));\n        this._chunks.push(...allAsBuffer);\n    }\n    append(field, value, contentType) {\n        const convertedValue = value instanceof Buffer ? value : value.toString();\n        const header = this.getMultipartHeader(field, convertedValue, contentType);\n        this.bodyAppend(header, convertedValue, FormDataHelper.LINE_BREAK);\n    }\n    getHeaders() {\n        return {\n            'content-type': 'multipart/form-data; boundary=' + this.getBoundary(),\n        };\n    }\n    /** Length of form-data (including footer length). */\n    getLength() {\n        return this._chunks.reduce((acc, cur) => acc + cur.length, this.getMultipartFooter().length);\n    }\n    getBuffer() {\n        const allChunks = [...this._chunks, this.getMultipartFooter()];\n        const totalBuffer = Buffer.alloc(this.getLength());\n        let i = 0;\n        for (const chunk of allChunks) {\n            for (let j = 0; j < chunk.length; i++, j++) {\n                totalBuffer[i] = chunk[j];\n            }\n        }\n        return totalBuffer;\n    }\n    getBoundary() {\n        if (!this._boundary) {\n            this.generateBoundary();\n        }\n        return this._boundary;\n    }\n    generateBoundary() {\n        // This generates a 50 character boundary similar to those used by Firefox.\n        let boundary = '--------------------------';\n        for (let i = 0; i < 24; i++) {\n            boundary += Math.floor(Math.random() * 10).toString(16);\n        }\n        this._boundary = boundary;\n    }\n    getMultipartHeader(field, value, contentType) {\n        // In this lib no need to guess more the content type, octet stream is ok of buffers\n        if (!contentType) {\n            contentType = value instanceof Buffer ? FormDataHelper.DEFAULT_CONTENT_TYPE : '';\n        }\n        const headers = {\n            'Content-Disposition': ['form-data', `name=\"${field}\"`],\n            'Content-Type': contentType,\n        };\n        let contents = '';\n        for (const [prop, header] of Object.entries(headers)) {\n            // skip nullish headers.\n            if (!header.length) {\n                continue;\n            }\n            contents += prop + ': ' + helpers_1.arrayWrap(header).join('; ') + FormDataHelper.LINE_BREAK;\n        }\n        return '--' + this.getBoundary() + FormDataHelper.LINE_BREAK + contents + FormDataHelper.LINE_BREAK;\n    }\n    getMultipartFooter() {\n        if (this._footerChunk) {\n            return this._footerChunk;\n        }\n        return this._footerChunk = Buffer.from('--' + this.getBoundary() + '--' + FormDataHelper.LINE_BREAK);\n    }\n}\nexports.FormDataHelper = FormDataHelper;\nFormDataHelper.LINE_BREAK = '\\r\\n';\nFormDataHelper.DEFAULT_CONTENT_TYPE = 'application/octet-stream';\n"]},"metadata":{},"sourceType":"script"}